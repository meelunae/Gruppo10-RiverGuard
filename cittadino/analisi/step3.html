<html>

<head>
    <link rel="stylesheet" href="../../assets/css/styles.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">

</head>

<body class="bg-secondary container">

    <div class="container">

        <div class="space-between align-items-center full-width">
            <a href="./step2.html">
                <i class="fas fa-arrow-left small-icon"></i>
            </a>
            <h1 class="primary-text-color">Nuova analisi</h1>
            <i class="fas fa-nope small-icon"></i>

        </div>

        <h1>Step 3 - Analisi</h1>

        <p class="small-text-description">Clicca sui colori assunti dalla striscia reagente</p>


        <div class="container">
            <div class="test-strip-line"></div>
            <div class="row align-items-center-row  mb-20" id="l1">
                <div class="left-color" style="background-color: #EDC130;"></div>

                <div class="color-box-warning space">
                    <div class="check-box space">
                        <input type="radio" class="square-radio" name="r1" style="background-color: #C4944A;"
                            value="0" />
                        <span>0</span>
                    </div>

                    <div class="check-box space">
                        <input type="radio" class="square-radio" name="r1" style="background-color: #C1912B;"
                            value="40" />
                        <span>40</span>
                    </div>

                    <div class="check-box">
                        <input type="radio" class="square-radio" name="r1" style="background-color: #BCA94D;"
                            value="80" />
                        <span>80</span>
                    </div>
                </div>

                <div class="color-box-ok space">
                    <div class="check-box">
                        <input type="radio" class="square-radio" name="r1" style="background-color: #6F8C7E;"
                            value="120" />
                        <span>120</span>
                    </div>
                </div>


                <div class="color-box-error">
                    <div class="check-box space">
                        <input type="radio" class="square-radio" name="r1" style="background-color: #4B8D7F;"
                            value="180" />
                        <span>180</span>
                    </div>

                    <div class="check-box space">
                        <input type="radio" class="square-radio" name="r1" style="background-color: #1A598F;"
                            value="180" />
                        <span>240</span>
                    </div>

                    <div class="check-box">
                        <input type="radio" class="square-radio" name="r1" style="background-color: #163474;"
                            value="400" />
                        <span>400</span>
                    </div>
                </div>

            </div>


            <div class="row align-items-center-row mb-20" id="l2">
                <div class="left-color" style="background-color: #EED728;"></div>

                <div class="color-box space">
                    <div class="check-box space">
                        <input type="radio" class="square-radio" name="r2" style="background-color: #F8EB00;"
                            value="6.2" />
                        <span>6.2</span>
                    </div>

                    <div class="check-box">
                        <input type="radio" class="square-radio" name="r2" style="background-color: #F8D204;"
                            value="6.8" />
                        <span>6.8</span>
                    </div>

                </div>

                <div class="color-box-ok space">
                    <div class="check-box space">
                        <input type="radio" class="square-radio" name="r2" style="background-color: #F89F03;"
                            value="7.2" />
                        <span>7.2</span>
                    </div>

                    <div class="check-box">
                        <input type="radio" class="square-radio" name="r2" style="background-color: #FA6801;"
                            value="7.6" />
                        <span>7.6</span>
                    </div>
                </div>


                <div class="color-box">
                    <div class="check-box space">
                        <input type="radio" class="square-radio" name="r2" style="background-color: #E84114;"
                            value="7.8" />
                        <span>7.8</span>
                    </div>

                    <div class="check-box">
                        <input type="radio" class="square-radio" name="r2" style="background-color: #CA5158;"
                            value="8.4" />
                        <span>8.4</span>
                    </div>

                </div>

            </div>


            <div class="row align-items-center-row mb-20" id="l3">
                <div class="left-color" style="background-color: #8D8208;"></div>

                <div class="color-box-warning space">
                    <div class="check-box space">
                        <input type="radio" class="square-radio" name="r3" style="background-color: #578642;"
                            value="0" />
                        <span>0</span>
                    </div>

                    <div class="check-box">
                        <input type="radio" class="square-radio" name="r3" style="background-color: #3D6A2D;"
                            value="25" />
                        <span>25</span>
                    </div>

                </div>

                <div class="color-box-ok space">
                    <div class="check-box space">
                        <input type="radio" class="square-radio" name="r3" style="background-color: #4F6B1E;"
                            value="50" />
                        <span>50</span>
                    </div>

                    <div class="check-box">
                        <input type="radio" class="square-radio" name="r3" style="background-color: #696507;"
                            value="125" />
                        <span>125</span>
                    </div>
                </div>


                <div class="color-box-error">
                    <div class="check-box space">
                        <input type="radio" class="square-radio" name="r3" style="background-color: #6F500B;"
                            value="250" />
                        <span>250</span>
                    </div>

                    <div class="check-box">
                        <input type="radio" class="square-radio" name="r3" style="background-color: #6C3B02;"
                            value="425" />
                        <span>425</span>
                    </div>

                </div>

            </div>

            <div class="row align-items-center-row mb-20" id="l4">
                <div class="left-color" style="background-color: #DFA245;"></div>

                <div class="color-box-ok space">
                    <div class="check-box">
                        <input type="radio" class="square-radio" name="r4" style="background-color: #FAC859;"
                            value="0" />
                        <span>0</span>
                    </div>

                </div>

                <div class="color-box-error space">
                    <div class="check-box space">
                        <input type="radio" class="square-radio" name="r4" style="background-color: #EAB541;"
                            value="20" />
                        <span>20</span>
                    </div>

                    <div class="check-box space">
                        <input type="radio" class="square-radio" name="r4" style="background-color: #E5A55D;"
                            value="50" />
                        <span>50</span>
                    </div>

                    <div class="check-box space">
                        <input type="radio" class="square-radio" name="r4" style="background-color: #EB7C2A;"
                            value="100" />
                        <span>100</span>
                    </div>

                    <div class="check-box space">
                        <input type="radio" class="square-radio" name="r4" style="background-color: #D56980;"
                            value="200" />
                        <span>200</span>
                    </div>

                    <div class="check-box">
                        <input type="radio" class="square-radio" name="r4" style="background-color: #BA226B;"
                            value="500" />
                        <span>500</span>
                    </div>
                </div>

            </div>

            <div class="row align-items-center-row mb-20" id="l5">
                <div class="left-color" style="background-color: #E8E9E4;"></div>

                <div class="color-box-ok space">
                    <div class="check-box">
                        <input type="radio" class="square-radio" name="r5" style="background-color: #FFFFFF;"
                            value="0" />
                        <span>0</span>
                    </div>

                </div>

                <div class="color-box-error space">
                    <div class="check-box space">
                        <input type="radio" class="square-radio" name="r5" style="background-color: #F1E9DC;"
                            value="5" />
                        <span>5</span>
                    </div>

                    <div class="check-box space">
                        <input type="radio" class="square-radio" name="r5" style="background-color: #F8E1CF;"
                            value="10" />
                        <span>10</span>
                    </div>

                    <div class="check-box space">
                        <input type="radio" class="square-radio" name="r5" style="background-color: #F3D2AF;"
                            value="25" />
                        <span>25</span>
                    </div>

                    <div class="check-box space">
                        <input type="radio" class="square-radio" name="r5" style="background-color: #F6C799;"
                            value="50" />
                        <span>50</span>
                    </div>

                    <div class="check-box space">
                        <input type="radio" class="square-radio" name="r5" style="background-color: #FBA55C;"
                            value="100" />
                        <span>100</span>
                    </div>

                    <!-- <div class="check-box space">
                        <input type="radio" class="square-radio" name="r5" style="background-color: #EA8E3B;"
                            value="250" />
                        <span>250</span>
                    </div> -->

                </div>

            </div>

            <div class="row align-items-center-row mb-20" id="l6">
                <div class="left-color" style="background-color: #E8E9E4;"></div>

                <div class="color-box-ok space">
                    <div class="check-box">
                        <input type="radio" class="square-radio" name="r6" style="background-color: #FDE8F7;"
                            value="0" />
                        <span>0</span>
                    </div>

                </div>

                <div class="color-box-error space">
                    <div class="check-box space">
                        <input type="radio" class="square-radio" name="r6" style="background-color: #E2D3FE;"
                            value="0.002" />
                        <span>0.002</span>
                    </div>

                    <div class="check-box space">
                        <input type="radio" class="square-radio" name="r6" style="background-color: #CABEE2;"
                            value="0.005" />
                        <span>0.005</span>
                    </div>

                    <div class="check-box space">
                        <input type="radio" class="square-radio" name="r6" style="background-color: #BBADDD;"
                            value="0.01" />
                        <span>0.01</span>
                    </div>

                    <div class="check-box space">
                        <input type="radio" class="square-radio" name="r6" style="background-color: #A277AF;"
                            value="0.02" />
                        <span>0.02</span>
                    </div>

                    <div class="check-box space">
                        <input type="radio" class="square-radio" name="r6" style="background-color: #654A7D;"
                            value="0.04" />
                        <span>0.04</span>
                    </div>

                    <!-- <div class="check-box space">
                        <input type="radio" class="square-radio" name="r6" style="background-color: #593267;"
                            value="0.08" />
                        <span>0.08</span>
                    </div> -->


                </div>

            </div>

            <div class="row align-items-center-row mb-20" id="l7">
                <div class="left-color" style="background-color: #E8E9E4;"></div>

                <div class="color-box-ok space">
                    <div class="check-box">
                        <input type="radio" class="square-radio" name="r7" style="background-color: #E1D1E0;"
                            value="2" />
                        <span>2</span>
                    </div>

                </div>

                <div class="color-box-error space">
                    <div class="check-box space">
                        <input type="radio" class="square-radio" name="r7" style="background-color: #D8B8DD;"
                            value="5" />
                        <span>5</span>
                    </div>

                    <div class="check-box space">
                        <input type="radio" class="square-radio" name="r7" style="background-color: #DCA6DA;"
                            value="10" />
                        <span>10</span>
                    </div>

                    <div class="check-box space">
                        <input type="radio" class="square-radio" name="r7" style="background-color: #C47A9B;"
                            value="30" />
                        <span>30</span>
                    </div>

                    <div class="check-box space">
                        <input type="radio" class="square-radio" name="r7" style="background-color: #A53F84;"
                            value="50" />
                        <span>50</span>
                    </div>

                    <div class="check-box space">
                        <input type="radio" class="square-radio" name="r7" style="background-color: #761856;"
                            value="100" />
                        <span>100</span>
                    </div>

                </div>

            </div>
        </div>


        <div class="modal" id="modal" style="display: none;">
            <div class="modal-bg"></div>
            <div class="modal-content">
                <div class="modal-body align-items-center">

                    <i class="fas fa-check big-icon"></i>


                    <h3 class="primary-text-color" style="margin-bottom: 5px;">
                        Analisi completata
                    </h3>
                    <span class="primary-text-color">
                        Grazie per averci dedicato il tuo tempo
                    </span>

                    <a href="../home.html">
                        <div class="m10">
                            <button class="full-width-primary-button primary-size asd">vai alla home</button>
                        </div>
                    </a>

                </div>
            </div>
        </div>


    </div>
    <div class="bottom-fixed m10  mb-30">
        <button class="full-width-primary-button" id="send">
            Continua
        </button>
    </div>


    <script>

        const saveAnalysis = obj => {
            const oldData = JSON.parse(localStorage.getItem("tempAnalysis"))
            const oldAnalysis = JSON.parse(localStorage.getItem("analysis")) || []

            const newItem = oldData
            oldData.radioValues = obj

            const tempAnalysis = [...oldAnalysis, newItem]

            localStorage.setItem("analysis", JSON.stringify(tempAnalysis))
            localStorage.removeItem("tempAnalysis")
            console.log("Temp analysis updated => ", localStorage.getItem("analysis"))
        }

        $("#send").click(() => {
            const radios = [1, 2, 3, 4, 5, 6, 7]
            const radioValues = radios.map(item => $("input[name='r" + item + "']:checked").val())

            $(".error-text").remove()

            let errors = 0
            const boxes = $(".align-items-center-row")

            radioValues.forEach((item, index) => {
                if (!item) {
                    console.log(index, " undefined")
                    let error = $('<p></p>').addClass("error-text").text("Quale colore vedi in questa riga?").css("margin", "5px").css("margin-left", "35px").css("font-size", "12px")
                    console.log("Error => ", error)

                    boxes[index].before(error.get(0))
                    errors += 1
                }
            })

            if (errors) return
            const obj = {
                radioValues
            }
            saveAnalysis(obj)
            $("#modal").css("display", "flex");

        });

    </script>



</body>

</html>